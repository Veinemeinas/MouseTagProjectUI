<p-table
  #dt
  [value]="candidates"
  dataKey="id"
  [rows]="10"
  [showCurrentPageReport]="true"
  [rowsPerPageOptions]="[10, 25, 50]"
  [loading]="loading"
  styleClass="p-datatable-customers"
  [paginator]="true"
  currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
  [globalFilterFields]="['name', 'surname']"
>
  <ng-template pTemplate="header">
    <tr>
      <th>
        <div class="p-d-flex">
          <span class="p-input-icon-left p-ml-auto">
            <i class="pi pi-search"></i>
            <input
              pInputText
              type="text"
              (input)="filterNames($event)"
              placeholder="Ieškoti"
            />
          </span>
        </div>
      </th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>
        <p-columnFilter
          field="representative"
          matchMode="in"
          [showMenu]="false"
        >
          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
            <p-multiSelect
              [options]="technologyOptions"
              placeholder="Pasirinkti"
              (onChange)="filterTechnologies($event)"
            >
            </p-multiSelect>
          </ng-template>
        </p-columnFilter>
      </th>
      <th></th>
      <th>
        <p-columnFilter type="boolean" field="available"></p-columnFilter>
      </th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th>Kada buvo susisiekta</th>
      <th>Vardas</th>
      <th>Pavardė</th>
      <th>LinkedIn nuoroda</th>
      <th>Komentaras</th>
      <th>Technologijos</th>
      <th>Kada reikia susisiekti</th>
      <th>Ar atviras pasiūlymams</th>
      <th></th>
      <th></th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-candidate>
    <tr>
      <td>
        {{ candidate.whenWasContacted[0] | date: "yyyy/MM/dd" }}
      </td>
      <td>
        <span>{{ candidate.name }}</span>
      </td>
      <td>
        <span>{{ candidate.surname }}</span>
      </td>
      <td>
        <span>{{ candidate.linkedin }}</span>
      </td>
      <td>
        <span>{{ candidate.comment }}</span>
      </td>
      <td>
        <span *ngFor="let technology of candidate.technologies"
          >{{ technology.technologyName }},&nbsp;</span
        >
      </td>
      <td>
        <span>{{ candidate.willBeContacted | date: "yyyy/MM/dd" }}</span>
      </td>
      <td>
        <i
          class="pi"
          [ngClass]="{
            'true-icon pi-check-circle': candidate.available,
            'false-icon pi-times-circle': !candidate.available
          }"
        ></i>
      </td>
      <td>
        <span
          ><button
            pButton
            pRipple
            class="p-button-rounded p-button-success p-mr-2"
            (click)="editCandidate(candidate)"
          >
            <span class="material-icons-sharp"> edit </span>
          </button></span
        >
      </td>
      <td>
        <span>
          <button
            pButton
            pRipple
            class="p-button-rounded p-button-warning"
            (click)="deleteCandidate(candidate)"
          >
            <span class="material-icons-sharp"> delete_forever </span>
          </button></span
        >
      </td>
    </tr>
  </ng-template>
  <ng-template pTemplate="emptymessage">
    <tr>
      <td colspan="5">Nerasta tokių kandidatų</td>
    </tr>
  </ng-template>
</p-table>

<p-dialog [(visible)]="editDialog" header="Redaguoti Kandidatą" [modal]="true" styleClass="p-fluid">
  <div class="row mb-3">
    <div class="col">
      <div class="p-field">
        <label class="mb-1" for="name">Vardas</label>
        <input
          type="name"
          [(ngModel)]="updateCandidate.name"
          pInputText id="name"
        />
      </div>
    </div>
    <div class="col">
      <div class="p-field">
        <label class="mb-1" for="surname">Pavardė</label>
        <input
          id="surname"
          name="surname"
          type="surname"
          [(ngModel)]="updateCandidate.surname"
          pInputText id="surname"
        />
      </div>
    </div>
  </div>
  <div class="row mb-3">
    <div class="col">
      <div class="p-field">
        <label class="mb-1" for="linkedIn">LinkedIn Url</label>
        <input
          id="linkedIn"
          name="linkedIn"
          type="linkedIn"
          [(ngModel)]="updateCandidate.linkedin"
          pInputText id="linkedIn"
        />
      </div>
    </div>
    <div class="col">
      <label class="mb-2" for="available">Ar atviras pasiūlymui?</label>
      <p-toggleButton
        name="available"
        [(ngModel)]="updateCandidate.available"
        onIcon="pi pi-check"
        offIcon="pi pi-times"
      ></p-toggleButton>
    </div>
  </div>
  <div class="row mb-3">
    <div class="col">
      <label class="mb-1" for="username1">Technologijos</label>
      <div class="p-field" style="width: 442px">
        <p-multiSelect
          name="technologyIds"
          [options]="technologyOptions"
          [(ngModel)]="updateCandidate.technologyIds"
          [style]="{ width: '100%' }"
          [panelStyle]="{ width: '100%' }"
        ></p-multiSelect>
      </div>
    </div>
  </div>
  <div class="row mb-3">
    <div class="col">
      <div class="p-field">
        <label class="mb-1" for="date1">Kada susiekta?</label>
        <p-calendar
          name="whenWasContacted"
          [(ngModel)]="updateCandidate.whenWasContacted"
          [showIcon]="true"
          inputId="icon"
        ></p-calendar>
      </div>
    </div>
    <div class="col">
      <div class="p-field">
        <label class="mb-1" for="date1">Planuojamas susitikimas</label>
        <p-calendar
          name="willBeContacted"
          [(ngModel)]="updateCandidate.willBeContacted"
          [showIcon]="true"
          inputId="icon"
        ></p-calendar>
      </div>
    </div>
  </div>
  <div class="row mb-3">
    <div class="col ms-auto">
      <div class="p-field" style="width: 442px; min-height: 200px">
        <label class="mb-1" for="username1">Komentaras</label>
        <textarea
          pInputTextarea
          [(ngModel)]="updateCandidate.comment"
          name="comments"
          [style]="{ width: '100%', height: '200px' }"
        ></textarea>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col"></div>
    <div class="col">
      <button pButton pRipple label="Save" icon="pi pi-check" class="p-button-text" (click)="saveCandidate()"></button>
    </div>
  </div>
</p-dialog>

